import * as tslib_1 from "tslib";
import { ChangeDetectionStrategy, Component, Inject, Input, ViewChild, } from '@angular/core';
import { ADSENSE_TOKEN } from './adsense-config';
var AdsenseComponent = /** @class */ (function () {
    function AdsenseComponent(config) {
        this.config = config;
        /** can be manually set if you need all ads on a page to have same id page-xxx */
        this.adRegion = 'page-' + Math.floor(Math.random() * 10000) + 1;
    }
    AdsenseComponent.prototype.ngOnInit = function () {
        var config = this.config;
        function use(source, defaultValue) {
            return config && source !== undefined ? source : defaultValue;
        }
        this.adClient = use(this.adClient, config.adClient);
        this.adSlot = use(this.adSlot, config.adSlot);
        this.adFormat = use(this.adFormat, config.adFormat || 'auto');
        this.display = use(this.display, config.display || 'block');
        this.width = use(this.width, config.width);
        this.height = use(this.height, config.height);
        this.layout = use(this.layout, config.layout);
        this.layoutKey = use(this.layoutKey, config.layoutKey);
        this.pageLevelAds = use(this.pageLevelAds, config.pageLevelAds);
        this.timeOutRetry = use(this.timeOutRetry, config.timeOutRetry || 200);
        this.adtest = use(this.adtest, config.adtest);
        this.fullWidthResponsive = use(this.fullWidthResponsive, config.fullWidthResponsive);
    };
    AdsenseComponent.prototype.ngOnDestroy = function () {
        var iframe = this.ins.nativeElement.querySelector('iframe');
        if (iframe && iframe.contentWindow) {
            iframe.src = 'about:blank';
            iframe.remove();
        }
    };
    /**
     * attempts to push the ad twice. Usually if one doesn't work the other
     * will depeding on if the browser has the adsense code cached and
     * if its the first page to be loaded
     */
    AdsenseComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        var res = this.push();
        if (res instanceof TypeError) {
            setTimeout(function () { return _this.push(); }, this.timeOutRetry);
        }
    };
    AdsenseComponent.prototype.push = function () {
        var p = {};
        if (this.pageLevelAds) {
            p.google_ad_client = this.adClient;
            p.enable_page_level_ads = true;
        }
        try {
            var adsbygoogle = window['adsbygoogle'];
            adsbygoogle.push(p);
            return true;
        }
        catch (e) {
            return e;
        }
    };
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], AdsenseComponent.prototype, "adClient", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], AdsenseComponent.prototype, "adSlot", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], AdsenseComponent.prototype, "adFormat", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], AdsenseComponent.prototype, "adRegion", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], AdsenseComponent.prototype, "display", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Number)
    ], AdsenseComponent.prototype, "width", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Number)
    ], AdsenseComponent.prototype, "height", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], AdsenseComponent.prototype, "layout", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], AdsenseComponent.prototype, "layoutKey", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Boolean)
    ], AdsenseComponent.prototype, "pageLevelAds", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Number)
    ], AdsenseComponent.prototype, "timeOutRetry", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], AdsenseComponent.prototype, "adtest", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Boolean)
    ], AdsenseComponent.prototype, "fullWidthResponsive", void 0);
    tslib_1.__decorate([
        ViewChild('ins'),
        tslib_1.__metadata("design:type", Object)
    ], AdsenseComponent.prototype, "ins", void 0);
    AdsenseComponent = tslib_1.__decorate([
        Component({
            selector: 'ng2-adsense,ng-adsense',
            template: "\n  <ins #ins class=\"adsbygoogle\"\n    [ngStyle]=\"{'display': display, 'width.px': width, 'height.px': height }\"\n    [attr.data-ad-client]=\"adClient\"\n    [attr.data-ad-slot]=\"adSlot\"\n    [attr.data-ad-format]=\"adFormat\"\n    [attr.data-ad-region]=\"adRegion\"\n    [attr.data-layout]=\"layout\"\n    [attr.data-adtest]=\"adtest\"\n    [attr.data-layout-key]=\"layoutKey\"\n    [attr.data-full-width-responsive]=\"fullWidthResponsive\">\n  </ins>\n  ",
            preserveWhitespaces: false,
            changeDetection: ChangeDetectionStrategy.OnPush
        }),
        tslib_1.__param(0, Inject(ADSENSE_TOKEN)),
        tslib_1.__metadata("design:paramtypes", [Object])
    ], AdsenseComponent);
    return AdsenseComponent;
}());
export { AdsenseComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRzZW5zZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZzItYWRzZW5zZS8iLCJzb3VyY2VzIjpbImFkc2Vuc2UuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBRUwsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFDVCxNQUFNLEVBQ04sS0FBSyxFQUdMLFNBQVMsR0FDVixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUsYUFBYSxFQUFpQixNQUFNLGtCQUFrQixDQUFDO0FBb0JoRTtJQTRCRSwwQkFDaUMsTUFBcUI7UUFBckIsV0FBTSxHQUFOLE1BQU0sQ0FBZTtRQXZCdEQsaUZBQWlGO1FBQ3hFLGFBQVEsR0FBRyxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBdUJoRSxDQUFDO0lBRUwsbUNBQVEsR0FBUjtRQUNFLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDM0IsU0FBUyxHQUFHLENBQUksTUFBUyxFQUFFLFlBQWU7WUFDeEMsT0FBTyxNQUFNLElBQUksTUFBTSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUM7UUFDaEUsQ0FBQztRQUNELElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3BELElBQUksQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzlDLElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLFFBQVEsSUFBSSxNQUFNLENBQUMsQ0FBQztRQUM5RCxJQUFJLENBQUMsT0FBTyxHQUFHLEdB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dUI7SUFFdEI7UUFBUixLQUFLLEVBQUU7OzBEQUFzQjtJQUVyQjtRQUFSLEtBQUssRUFBRTs7b0RBQWdCO0lBRWY7UUFBUixLQUFLLEVBQUU7O2lFQUE4QjtJQUNwQjtRQUFqQixTQUFTLENBQUMsS0FBSyxDQUFDOztpREFBVTtJQTFCaEIsZ0JBQWdCO1FBbEI1QixTQUFTLENBQUM7WUFDVCxRQUFRLEVBQUUsd0JBQXdCO1lBQ2xDLFFBQVEsRUFBRSxnZEFZVDtZQUNELG1CQUFtQixFQUFFLEtBQUs7WUFDMUIsZUFBZSxFQUFFLHVCQUF1QixDQUFDLE1BQU07U0FDaEQsQ0FBQztRQThCRyxtQkFBQSxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUE7O09BN0JiLGdCQUFnQixDQW9GNUI7SUFBRCx1QkFBQztDQUFBLEFBcEZELElBb0ZDO1NBcEZZLGdCQUFnQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0luaXQsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDb21wb25lbnQsXG4gIEluamVjdCxcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBWaWV3Q2hpbGQsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBBRFNFTlNFX1RPS0VOLCBBZHNlbnNlQ29uZmlnIH0gZnJvbSAnLi9hZHNlbnNlLWNvbmZpZyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ25nMi1hZHNlbnNlLG5nLWFkc2Vuc2UnLFxuICB0ZW1wbGF0ZTogYFxuICA8aW5zICNpbnMgY2xhc3M9XCJhZHNieWdvb2dsZVwiXG4gICAgW25nU3R5bGVdPVwieydkaXNwbGF5JzogZGlzcGxheSwgJ3dpZHRoLnB4Jzogd2lkdGgsICdoZWlnaHQucHgnOiBoZWlnaHQgfVwiXG4gICAgW2F0dHIuZGF0YS1hZC1jbGllbnRdPVwiYWRDbGllbnRcIlxuICAgIFthdHRyLmRhdGEtYWQtc2xvdF09XCJhZFNsb3RcIlxuICAgIFthdHRyLmRhdGEtYWQtZm9ybWF0XT1cImFkRm9ybWF0XCJcbiAgICBbYXR0ci5kYXRhLWFkLXJlZ2lvbl09XCJhZFJlZ2lvblwiXG4gICAgW2F0dHIuZGF0YS1sYXlvdXRdPVwibGF5b3V0XCJcbiAgICBbYXR0ci5kYXRhLWFkdGVzdF09XCJhZHRlc3RcIlxuICAgIFthdHRyLmRhdGEtbGF5b3V0LWtleV09XCJsYXlvdXRLZXlcIlxuICAgIFthdHRyLmRhdGEtZnVsbC13aWR0aC1yZXNwb25zaXZlXT1cImZ1bGxXaWR0aFJlc3BvbnNpdmVcIj5cbiAgPC9pbnM+XG4gIGAsXG4gIHByZXNlcnZlV2hpdGVzcGFjZXM6IGZhbHNlLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbn0pXG5leHBvcnQgY2xhc3MgQWRzZW5zZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcbiAgLyoqIGFkc2Vuc2UgYWNjb3VudCBjYS1wdWItWFhYWFhYWFhYWFhYWFhYWCAqL1xuICBASW5wdXQoKSBhZENsaWVudDogc3RyaW5nO1xuICAvKiogYWQgc2xvdC9udW1iZXIgKi9cbiAgQElucHV0KCkgYWRTbG90OiBzdHJpbmcgfCBudW1iZXI7XG4gIEBJbnB1dCgpIGFkRm9ybWF0OiBzdHJpbmc7XG4gIC8qKiBjYW4gYmUgbWFudWFsbHkgc2V0IGlmIHlvdSBuZWVkIGFsbCBhZHMgb24gYSBwYWdlIHRvIGhhdmUgc2FtZSBpZCBwYWdlLXh4eCAqL1xuICBASW5wdXQoKSBhZFJlZ2lvbiA9ICdwYWdlLScgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCkgKyAxO1xuICAvKiogaW5zIGVsZW1lbnQgZGlzcGxheSBzdHlsZSAqL1xuICBASW5wdXQoKSBkaXNwbGF5OiBzdHJpbmc7XG4gIC8qKiBpbnMgZWxlbWVudCBoZWlnaHQgaW4gcHggKi9cbiAgQElucHV0KCkgd2lkdGg6IG51bWJlcjtcbiAgLyoqIGlucyBlbGVtZW50IHdpZHRoIGluIHB4ICovXG4gIEBJbnB1dCgpIGhlaWdodDogbnVtYmVyO1xuICAvKiogdXNlZCBmb3IgaW4tZmVlZCBhZHMgKi9cbiAgQElucHV0KCkgbGF5b3V0OiBzdHJpbmc7XG4gIC8qKiB1c2VkIGZvciBpbi1mZWVkIGFkcyAqL1xuICBASW5wdXQoKSBsYXlvdXRLZXk6IHN0cmluZztcbiAgLyoqIGVuYWJsZSBwYWdlLWxldmVsIGFkcyAqL1xuICBASW5wdXQoKSBwYWdlTGV2ZWxBZHM6IGJvb2xlYW47XG4gIC8qKiBvbiBmaXJzdCBsb2FkIHNvbWV0aW1lcyBhZHNlbnNlIGlzIG5vdCByZWFkeSAqL1xuICBASW5wdXQoKSB0aW1lT3V0UmV0cnk6IG51bWJlcjtcbiAgLyoqIHNldHMgdXAgc29tZSBzb3J0IG9mIGdvb2dsZSB0ZXN0IGFkICovXG4gIEBJbnB1dCgpIGFkdGVzdDogc3RyaW5nO1xuICAvKiB1c2VkIGZvciBmbGV4aWJsZSBhZHMgKi9cbiAgQElucHV0KCkgZnVsbFdpZHRoUmVzcG9uc2l2ZTogYm9vbGVhbjtcbiAgQFZpZXdDaGlsZCgnaW5zJykgaW5zOiBhbnk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgQEluamVjdChBRFNFTlNFX1RPS0VOKSBwcml2YXRlIGNvbmZpZzogQWRzZW5zZUNvbmZpZyxcbiAgKSB7IH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBjb25zdCBjb25maWcgPSB0aGlzLmNvbmZpZztcbiAgICBmdW5jdGlvbiB1c2U8VD4oc291cmNlOiBULCBkZWZhdWx0VmFsdWU6IFQpOiBUIHtcbiAgICAgIHJldHVybiBjb25maWcgJiYgc291cmNlICE9PSB1bmRlZmluZWQgPyBzb3VyY2UgOiBkZWZhdWx0VmFsdWU7XG4gICAgfVxuICAgIHRoaXMuYWRDbGllbnQgPSB1c2UodGhpcy5hZENsaWVudCwgY29uZmlnLmFkQ2xpZW50KTtcbiAgICB0aGlzLmFkU2xvdCA9IHVzZSh0aGlzLmFkU2xvdCwgY29uZmlnLmFkU2xvdCk7XG4gICAgdGhpcy5hZEZvcm1hdCA9IHVzZSh0aGlzLmFkRm9ybWF0LCBjb25maWcuYWRGb3JtYXQgfHwgJ2F1dG8nKTtcbiAgICB0aGlzLmRpc3BsYXkgPSB1c2UodGhpcy5kaXNwbGF5LCBjb25maWcuZGlzcGxheSB8fCAnYmxvY2snKTtcbiAgICB0aGlzLndpZHRoID0gdXNlKHRoaXMud2lkdGgsIGNvbmZpZy53aWR0aCk7XG4gICAgdGhpcy5oZWlnaHQgPSB1c2UodGhpcy5oZWlnaHQsIGNvbmZpZy5oZWlnaHQpO1xuICAgIHRoaXMubGF5b3V0ID0gdXNlKHRoaXMubGF5b3V0LCBjb25maWcubGF5b3V0KTtcbiAgICB0aGlzLmxheW91dEtleSA9IHVzZSh0aGlzLmxheW91dEtleSwgY29uZmlnLmxheW91dEtleSk7XG4gICAgdGhpcy5wYWdlTGV2ZWxBZHMgPSB1c2UodGhpcy5wYWdlTGV2ZWxBZHMsIGNvbmZpZy5wYWdlTGV2ZWxBZHMpO1xuICAgIHRoaXMudGltZU91dFJldHJ5ID0gdXNlKHRoaXMudGltZU91dFJldHJ5LCBjb25maWcudGltZU91dFJldHJ5IHx8IDIwMCk7XG4gICAgdGhpcy5hZHRlc3QgPSB1c2UodGhpcy5hZHRlc3QsIGNvbmZpZy5hZHRlc3QpO1xuICAgIHRoaXMuZnVsbFdpZHRoUmVzcG9uc2l2ZSA9IHVzZSh0aGlzLmZ1bGxXaWR0aFJlc3BvbnNpdmUsIGNvbmZpZy5mdWxsV2lkdGhSZXNwb25zaXZlKTtcbiAgfVxuICBuZ09uRGVzdHJveSgpIHtcbiAgICBjb25zdCBpZnJhbWUgPSB0aGlzLmlucy5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lmcmFtZScpO1xuICAgIGlmIChpZnJhbWUgJiYgaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgIGlmcmFtZS5zcmMgPSAnYWJvdXQ6YmxhbmsnO1xuICAgICAgaWZyYW1lLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBhdHRlbXB0cyB0byBwdXNoIHRoZSBhZCB0d2ljZS4gVXN1YWxseSBpZiBvbmUgZG9lc24ndCB3b3JrIHRoZSBvdGhlclxuICAgKiB3aWxsIGRlcGVkaW5nIG9uIGlmIHRoZSBicm93c2VyIGhhcyB0aGUgYWRzZW5zZSBjb2RlIGNhY2hlZCBhbmRcbiAgICogaWYgaXRzIHRoZSBmaXJzdCBwYWdlIHRvIGJlIGxvYWRlZFxuICAgKi9cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIGNvbnN0IHJlcyA9IHRoaXMucHVzaCgpO1xuICAgIGlmIChyZXMgaW5zdGFuY2VvZiBUeXBlRXJyb3IpIHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5wdXNoKCksIHRoaXMudGltZU91dFJldHJ5KTtcbiAgICB9XG4gIH1cblxuICBwdXNoKCkge1xuICAgIGNvbnN0IHA6IGFueSA9IHt9O1xuICAgIGlmICh0aGlzLnBhZ2VMZXZlbEFkcykge1xuICAgICAgcC5nb29nbGVfYWRfY2xpZW50ID0gdGhpcy5hZENsaWVudDtcbiAgICAgIHAuZW5hYmxlX3BhZ2VfbGV2ZWxfYWRzID0gdHJ1ZTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGFkc2J5Z29vZ2xlID0gd2luZG93WydhZHNieWdvb2dsZSddO1xuICAgICAgYWRzYnlnb29nbGUucHVzaChwKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgfVxufVxuXG4iXX0=